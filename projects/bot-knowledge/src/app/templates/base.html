<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}ChromaDB Document Manager{% endblock %}</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Feather Icons -->
    <script src="https://unpkg.com/feather-icons"></script>
    
    <!-- Chart.js for visualizations -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="/static/css/main.css">
    
    <style>
        /* Enhanced Custom CSS Variables - Matching main.css design tokens */
        :root {
            /* Legacy support (keeping for compatibility) */
            --primary-color: var(--color-blue-600);
            --primary-hover: var(--color-blue-700);
            --secondary-color: var(--color-gray-600);
            --success-color: var(--color-green-500);
            --error-color: var(--color-red-500);
            --warning-color: var(--color-yellow-500);
            --surface-color: var(--color-white);
            --background-color: var(--color-gray-50);
            --text-primary: var(--color-gray-900);
            --text-secondary: var(--color-gray-600);
            --border-color: var(--color-gray-200);
        }
        
        /* Enhanced animations using design tokens */
        @keyframes fadeIn {
            from { 
                opacity: 0; 
                transform: translateY(var(--space-2)); 
            }
            to { 
                opacity: 1; 
                transform: translateY(0); 
            }
        }
        
        @keyframes slideIn {
            from { transform: translateX(-100%); }
            to { transform: translateX(0); }
        }
        
        .fade-in {
            animation: fadeIn var(--transition-slow) ease-out;
        }
        
        .slide-in {
            animation: slideIn var(--transition-slow) ease-out;
        }
        
        /* Enhanced loading spinner */
        .spinner {
            border: 2px solid var(--color-gray-200);
            border-top: 2px solid var(--color-blue-600);
            border-radius: 50%;
            width: var(--space-5);
            height: var(--space-5);
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Custom scrollbar - Minimalist */
        .custom-scrollbar::-webkit-scrollbar {
            width: var(--space-1);
        }
        
        .custom-scrollbar::-webkit-scrollbar-track {
            background: var(--color-gray-100);
        }
        
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: var(--color-gray-300);
            border-radius: var(--radius-sm);
        }
        
        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: var(--color-gray-400);
        }
        
        /* Enhanced body styling */
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--color-gray-50);
            color: var(--color-gray-900);
            line-height: 1.5;
        }
    </style>
    
    {% block extra_head %}{% endblock %}
</head>
<body class="min-h-screen">
    <!-- Navigation Header - Minimalist Design -->
    <nav style="background: var(--color-white); box-shadow: var(--shadow-sm); border-bottom: 1px solid var(--color-gray-200);">
        <div style="max-width: 1280px; margin: 0 auto; padding: 0 var(--space-4);">
            <div style="display: flex; justify-content: space-between; height: var(--space-8);">
                <!-- Logo and Title -->
                <div style="display: flex; align-items: center;">
                    <div style="display: flex; align-items: center; flex-shrink: 0;">
                        <div style="width: var(--space-4); height: var(--space-4); background: var(--color-blue-600); border-radius: var(--radius-md); display: flex; align-items: center; justify-content: center;">
                            <i data-feather="database" style="width: var(--space-3); height: var(--space-3); color: var(--color-white);"></i>
                        </div>
                        <h1 style="margin-left: var(--space-3); font-size: var(--text-xl); font-weight: var(--font-semibold); color: var(--color-gray-900); margin-top: 0; margin-bottom: 0;">ChromaDB Manager</h1>
                    </div>
                </div>
                
                <!-- Navigation Tabs -->
                <div style="display: flex; align-items: center; gap: var(--space-2);">
                    <a href="/" 
                       class="nav-link {% if request.url.path == '/' %}active{% endif %}">
                        <i data-feather="home"></i>
                        Dashboard
                    </a>
                    <a href="/documents" 
                       class="nav-link {% if 'documents' in request.url.path %}active{% endif %}">
                        <i data-feather="file-text"></i>
                        Documents
                    </a>
                    <a href="/search" 
                       class="nav-link {% if 'search' in request.url.path %}active{% endif %}">
                        <i data-feather="search"></i>
                        Search
                    </a>
                    <a href="/upload" 
                       class="nav-link {% if 'upload' in request.url.path %}active{% endif %}">
                        <i data-feather="upload"></i>
                        Upload
                    </a>
                </div>
                
                <!-- User Menu -->
                <div style="display: flex; align-items: center;">
                    <button style="padding: var(--space-2); border-radius: var(--radius-md); color: var(--color-gray-400); transition: all var(--transition-normal); border: none; background: none; cursor: pointer;" 
                            onmouseover="this.style.color='var(--color-gray-500)'; this.style.background='var(--color-gray-100)'" 
                            onmouseout="this.style.color='var(--color-gray-400)'; this.style.background='none'">
                        <i data-feather="settings" style="width: var(--space-3); height: var(--space-3);"></i>
                    </button>
                </div>
            </div>
        </div>
    </nav>
    
    <!-- Main Content - Minimalist Design -->
    <main style="max-width: 1280px; margin: 0 auto; padding: var(--space-6) var(--space-4);">
        {% block content %}{% endblock %}
    </main>
    
    <!-- Floating Action Button - Minimalist Design -->
    <button id="fab" style="
        position: fixed; 
        bottom: var(--space-6); 
        right: var(--space-6); 
        width: var(--space-12); 
        height: var(--space-12); 
        background: var(--color-blue-600); 
        color: var(--color-white); 
        border-radius: 50%; 
        box-shadow: var(--shadow-lg); 
        transition: all var(--transition-normal); 
        z-index: 50;
        border: none;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;"
        onmouseover="this.style.background='var(--color-blue-700)'; this.style.boxShadow='var(--shadow-xl)'; this.style.transform='scale(1.05)'"
        onmouseout="this.style.background='var(--color-blue-600)'; this.style.boxShadow='var(--shadow-lg)'; this.style.transform='scale(1)'">
        <i data-feather="plus" style="width: var(--space-6); height: var(--space-6);"></i>
    </button>
    
    <!-- Toast Notifications Container - Minimalist Design -->
    <div id="toast-container" style="position: fixed; top: var(--space-4); right: var(--space-4); z-index: 50; display: flex; flex-direction: column; gap: var(--space-2);"></div>
    
    <!-- Loading Overlay - Minimalist Design -->
    <div id="loading-overlay" style="position: fixed; inset: 0; background: rgba(0, 0, 0, 0.5); display: flex; align-items: center; justify-content: center; z-index: 50;" class="hidden">
        <div style="background: var(--color-white); border-radius: var(--radius-lg); padding: var(--space-6); display: flex; align-items: center; gap: var(--space-3); box-shadow: var(--shadow-lg);">
            <div class="spinner"></div>
            <span style="color: var(--color-gray-700); font-size: var(--text-sm);">Loading...</span>
        </div>
    </div>
    
    <!-- Confirmation Modal - Minimalist Design -->
    <div id="confirm-modal" style="position: fixed; inset: 0; background: rgba(0, 0, 0, 0.5); display: flex; align-items: center; justify-content: center; z-index: 50;" class="hidden">
        <div style="background: var(--color-white); border-radius: var(--radius-lg); padding: var(--space-6); max-width: 448px; width: 100%; margin: 0 var(--space-4); box-shadow: var(--shadow-lg);">
            <h3 style="font-size: var(--text-lg); font-weight: var(--font-semibold); color: var(--color-gray-900); margin-bottom: var(--space-2); margin-top: 0;" id="confirm-title">Confirm Action</h3>
            <p style="color: var(--color-gray-600); margin-bottom: var(--space-4); font-size: var(--text-sm); line-height: 1.5;" id="confirm-message">Are you sure you want to proceed?</p>
            <div style="display: flex; justify-content: flex-end; gap: var(--space-3);">
                <button id="confirm-cancel" style="padding: var(--space-2) var(--space-4); color: var(--color-gray-500); transition: color var(--transition-normal); border: none; background: none; cursor: pointer; border-radius: var(--radius-md); font-size: var(--text-sm);"
                        onmouseover="this.style.color='var(--color-gray-700)'"
                        onmouseout="this.style.color='var(--color-gray-500)'">
                    Cancel
                </button>
                <button id="confirm-proceed" style="padding: var(--space-2) var(--space-4); background: var(--color-red-600); color: var(--color-white); border-radius: var(--radius-md); transition: background var(--transition-normal); border: none; cursor: pointer; font-size: var(--text-sm);"
                        onmouseover="this.style.background='var(--color-red-700)'"
                        onmouseout="this.style.background='var(--color-red-600)'">
                    Confirm
                </button>
            </div>
        </div>
    </div>
    
    <!-- JavaScript Libraries -->
    <script src="/static/js/utils.js"></script>
    <script src="/static/js/api.js"></script>
    
    <!-- Initialize Feather Icons and Enhanced Navigation -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            feather.replace();
            
            // Enhanced navigation styles using design tokens
            const navLinks = document.querySelectorAll('.nav-link');
            navLinks.forEach(link => {
                if (link.classList.contains('active')) {
                    // Active state styling
                    link.style.color = 'var(--color-blue-600)';
                    link.style.background = 'var(--color-blue-50)';
                } else {
                    // Default state styling
                    link.style.color = 'var(--color-gray-500)';
                    link.style.background = 'transparent';
                }
                
                // Hover effect handlers
                link.addEventListener('mouseenter', function() {
                    if (!this.classList.contains('active')) {
                        this.style.color = 'var(--color-gray-700)';
                        this.style.background = 'var(--color-gray-50)';
                    }
                });
                
                link.addEventListener('mouseleave', function() {
                    if (!this.classList.contains('active')) {
                        this.style.color = 'var(--color-gray-500)';
                        this.style.background = 'transparent';
                    }
                });
            });
            
            // FAB click handler
            document.getElementById('fab').addEventListener('click', function() {
                window.location.href = "/upload";
            });
        });
    </script>
    
    {% block extra_scripts %}{% endblock %}
</body>
</html>