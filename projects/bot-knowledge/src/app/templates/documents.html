{% extends "base.html" %}

{% block title %}Documents - ChromaDB Document Manager{% endblock %}

{% block content %}
<!-- Documents Header - Minimalist Design -->
<div style="display: flex; flex-direction: column; margin-bottom: var(--space-6);">
    <div style="display: flex; align-items: flex-start; justify-content: space-between; margin-bottom: var(--space-4);">
        <div>
            <h1 style="font-size: var(--text-4xl); font-weight: var(--font-bold); color: var(--color-gray-900); margin-bottom: var(--space-2); margin-top: 0;">Documents</h1>
            <p style="color: var(--color-gray-600); font-size: var(--text-base); margin: 0; line-height: 1.5;">Manage and organize your document collection</p>
        </div>
        <div style="display: flex; gap: var(--space-3); margin-top: var(--space-4);">
            <button id="view-toggle" class="btn btn-secondary">
                <i data-feather="grid" style="width: var(--space-2); height: var(--space-2); margin-right: var(--space-1);"></i>
                Grid View
            </button>
            <button onclick="window.location.href='/upload'" class="btn btn-primary">
                <i data-feather="upload" style="width: var(--space-2); height: var(--space-2); margin-right: var(--space-1);"></i>
                Upload Documents
            </button>
        </div>
    </div>
</div>

<!-- Documents Header Responsive CSS -->
<style>
@media (max-width: 640px) {
    .documents-header {
        flex-direction: column !important;
    }
    .documents-header > div:first-child {
        margin-bottom: var(--space-4);
    }
    .documents-header > div:last-child {
        margin-top: 0 !important;
    }
}
</style>

<!-- Search and Filters - Enhanced Minimalist Design -->
<div id="search-filters-grid" style="display: grid; grid-template-columns: 1fr; gap: var(--space-4); margin-bottom: var(--space-6);">
    <!-- Search Bar -->
    <div style="grid-column: 1;">
        <div style="position: relative;">
            <div style="position: absolute; top: 0; left: 0; height: 100%; padding-left: var(--space-3); display: flex; align-items: center; pointer-events: none;">
                <i data-feather="search" style="width: var(--space-3); height: var(--space-3); color: var(--color-gray-400);"></i>
            </div>
            <input type="text" id="search-input" 
                   style="display: block; width: 100%; padding: var(--space-2) var(--space-3) var(--space-2) var(--space-10); border: 1px solid var(--color-gray-300); border-radius: var(--radius-md); background: var(--color-white); color: var(--color-gray-900); font-size: var(--text-sm); transition: all var(--transition-normal);"
                   placeholder="Search documents..."
                   onfocus="this.style.borderColor='var(--color-blue-500)'; this.style.boxShadow='0 0 0 3px rgba(59, 130, 246, 0.1)'"
                   onblur="this.style.borderColor='var(--color-gray-300)'; this.style.boxShadow='none'" />
        </div>
    </div>
    
    <!-- Filters -->
    <div>
        <button id="filter-toggle" class="btn btn-secondary" style="width: 100%; justify-content: center;">
            <i data-feather="filter" style="width: var(--space-2); height: var(--space-2); margin-right: var(--space-1);"></i>
            Filters
            <span id="filter-count" style="margin-left: var(--space-2); background: var(--color-blue-100); color: var(--color-blue-800); font-size: var(--text-xs); border-radius: var(--radius-xl); padding: var(--space-1) var(--space-2); display: none;">0</span>
        </button>
    </div>
</div>

<!-- Search Filters Responsive CSS -->
<style>
@media (min-width: 1024px) {
    #search-filters-grid {
        grid-template-columns: 3fr 1fr;
    }
}
</style>

<!-- Filter Sidebar - Minimalist Design -->
<div id="filter-sidebar" style="margin-bottom: var(--space-6);" class="hidden">
    <div class="card">
        <div class="card-header">
            <h3 class="card-title">Filters</h3>
            <button id="clear-filters" style="font-size: var(--text-sm); color: var(--color-gray-500); transition: color var(--transition-normal); border: none; background: none; cursor: pointer;"
                    onmouseover="this.style.color='var(--color-gray-700)'"
                    onmouseout="this.style.color='var(--color-gray-500)'">Clear All</button>
        </div>
        <div style="display: flex; flex-direction: column; gap: var(--space-4);">
            <!-- Category Filter -->
            <div>
                <label class="form-label">Category</label>
                <select id="category-filter" class="form-select">
                    <option value="">All Categories</option>
                </select>
            </div>
            
            <!-- Date Range Filter -->
            <div>
                <label class="form-label">Date Range</label>
                <select id="date-filter" class="form-select">
                    <option value="">All Time</option>
                    <option value="today">Today</option>
                    <option value="week">This Week</option>
                    <option value="month">This Month</option>
                    <option value="year">This Year</option>
                </select>
            </div>
            
            <!-- Author Filter -->
            <div>
                <label class="form-label">Author</label>
                <select id="author-filter" class="form-select">
                    <option value="">All Authors</option>
                </select>
            </div>
        </div>
    </div>
</div>

<!-- Bulk Actions Bar - Minimalist Design -->
<div id="bulk-actions" style="margin-bottom: var(--space-6);" class="hidden">
    <div style="background: rgba(59, 130, 246, 0.05); border: 1px solid var(--color-blue-200); border-radius: var(--radius-lg); padding: var(--space-4);">
        <div style="display: flex; align-items: center; justify-content: space-between;">
            <div style="display: flex; align-items: center;">
                <span style="font-size: var(--text-sm); color: var(--color-blue-800);">
                    <span id="selected-count">0</span> documents selected
                </span>
            </div>
            <div style="display: flex; gap: var(--space-2);">
                <button id="bulk-delete" class="btn btn-danger btn-sm">
                    <i data-feather="trash-2" style="width: var(--space-2); height: var(--space-2); margin-right: var(--space-1);"></i>
                    Delete Selected
                </button>
                <button id="deselect-all" class="btn btn-secondary btn-sm">
                    Deselect All
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Documents Grid/List - Minimalist Design -->
<div id="documents-container">
    <!-- Loading State -->
    <div id="loading-documents" style="text-align: center; padding: var(--space-12) 0;">
        <div class="spinner" style="margin: 0 auto var(--space-4);"></div>
        <p style="color: var(--color-gray-500); font-size: var(--text-sm); margin: 0;">Loading documents...</p>
    </div>
    
    <!-- Documents Grid -->
    <div id="documents-grid" class="document-grid hidden"></div>
    
    <!-- Documents List -->
    <div id="documents-list" style="display: flex; flex-direction: column; gap: var(--space-3);" class="hidden"></div>
    
    <!-- Empty State -->
    <div id="empty-state" style="text-align: center; padding: var(--space-12) 0;" class="hidden">
        <i data-feather="inbox" style="width: var(--space-10); height: var(--space-10); margin: 0 auto var(--space-4); color: var(--color-gray-300);"></i>
        <h3 style="font-size: var(--text-lg); font-weight: var(--font-medium); color: var(--color-gray-900); margin-bottom: var(--space-2); margin-top: 0;">No documents found</h3>
        <p style="color: var(--color-gray-500); margin-bottom: var(--space-6); font-size: var(--text-sm); line-height: 1.5;">Get started by uploading your first document</p>
        <button onclick="window.location.href='/upload'" class="btn btn-primary">
            <i data-feather="upload" style="width: var(--space-2); height: var(--space-2); margin-right: var(--space-1);"></i>
            Upload Documents
        </button>
    </div>
</div>

<!-- Pagination - Minimalist Design -->
<div id="pagination-container" style="margin-top: var(--space-8);" class="hidden">
    <div class="pagination">
        <div class="pagination-info">
            <p style="font-size: var(--text-sm); color: var(--color-gray-700);">
                Showing <span id="page-start">1</span> to <span id="page-end">10</span> of <span id="total-documents">0</span> documents
            </p>
        </div>
        <div class="pagination-nav">
            <button id="prev-page" class="pagination-btn" disabled>
                <i data-feather="chevron-left" style="width: var(--space-2); height: var(--space-2);"></i>
            </button>
            <div id="page-numbers" style="display: flex; gap: var(--space-1);"></div>
            <button id="next-page" class="pagination-btn" disabled>
                <i data-feather="chevron-right" style="width: var(--space-2); height: var(--space-2);"></i>
            </button>
        </div>
    </div>
</div>

<!-- Document Detail Modal - Minimalist Design -->
<div id="document-modal" style="position: fixed; inset: 0; background: rgba(0, 0, 0, 0.5); display: flex; align-items: center; justify-content: center; z-index: 50;" class="hidden">
    <div style="background: var(--color-white); border-radius: var(--radius-lg); box-shadow: var(--shadow-lg); width: 100%; max-width: 1024px; margin: 0 var(--space-4); max-height: 90vh; overflow: hidden;">
        <div style="display: flex; align-items: center; justify-content: space-between; padding: var(--space-6); border-bottom: 1px solid var(--color-gray-200);">
            <h2 style="font-size: var(--text-xl); font-weight: var(--font-semibold); color: var(--color-gray-900); margin: 0;" id="modal-title">Document Details</h2>
            <button id="close-modal" style="color: var(--color-gray-400); transition: color var(--transition-normal); border: none; background: none; cursor: pointer; padding: var(--space-1); border-radius: var(--radius-sm);"
                    onmouseover="this.style.color='var(--color-gray-600)'"
                    onmouseout="this.style.color='var(--color-gray-400)'">
                <i data-feather="x" style="width: var(--space-6); height: var(--space-6);"></i>
            </button>
        </div>
        <div style="padding: var(--space-6); overflow-y: auto; max-height: 70vh;" id="modal-content">
            <!-- Content will be loaded dynamically -->
        </div>
        <div style="display: flex; align-items: center; justify-content: flex-end; gap: var(--space-3); padding: var(--space-6); border-top: 1px solid var(--color-gray-200);">
            <button id="edit-document" class="btn btn-secondary">
                <i data-feather="edit" style="width: var(--space-2); height: var(--space-2); margin-right: var(--space-1);"></i>
                Edit
            </button>
            <button id="delete-document" class="btn btn-danger">
                <i data-feather="trash-2" style="width: var(--space-2); height: var(--space-2); margin-right: var(--space-1);"></i>
                Delete
            </button>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_scripts %}
<script src="/static/js/documents.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Initialize the documents page
    DocumentManager.init();
});
</script>
{% endblock %}